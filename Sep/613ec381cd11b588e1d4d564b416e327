Dimitrov broke Federer twice on the way to a 4-0 lead in the final set and the 38-year-old Swiss star had no effective reply, foiled by 61 unforced errors in falling after three hours and 12 minutes. NEW YORK - Grigor Dimitrov rallied for a shocking upset of 20-time Grand Slam champion Roger Federer at the US Open on Tuesday, the lowest-ranked New York semifinalist in 28 years advancing to face Daniil Medvedev. The 78th-ranked Bulgarian, who had dropped all seven prior meetings with Federer, made a dramatic fightback to defeat the Swiss third seed 3-6, 6-4, 3-6, 6-4, 6-2 at Arthur Ashe Stadium and will face Russian fifth seed Medvedev in Friday's semis. "I'm just happy," Dimitrov said. "The only thing I was telling myself was to stay in the match. Physically I was feeling pretty good. I was hitting some shots against him that were hard to hit." Dimitrov reached his first US Open semifinal to match the deepest Slam runs of his career from Wimbledon in 2014 and the 2017 Australian Open. Not since 174th-ranked Jimmy Connors reached the 1991 quarterfinals had New York seen so lowly a figure on the ATP ratings list reach the last four. Dimitrov is also the lowest-ranked Slam semifinalist since 94th-rated Rainer Schuettler of Germany at Wimbledon in 2008. Federer, a five-time US Open champion who has not won at Flushing Meadows since 2008, breezed through the first set in 29 minutes and appeared to have withstood the danger until Dimitrov opened the fourth set with a break. Federer was denied on five break points in the 10th game of the fourth set and Dimitrov held to force a fifth set. "I was trying to stay in that game and make him stay on the court as much as possible. After that he started slowing down a little bit," Dimitrov said. "It's a best of five sets. Anything can happen." Federer went off the court for a private medical timeout to treat his upper back near his neck. "This is Grigor's moment, not my body's moment," Federer said. Dimitrov broke Federer twice on the way to a 4-0 lead in the final set and the 38-year-old Swiss star had no effective reply, foiled by 61 unforced errors in falling after three hours and 12 minutes. "It's OK. It's how it goes," Federer said. "I tried my best. I fought with what I had and that's it." Federer would have become the oldest Slam semi-finalist since Jimmy Connors at age 39 at the 1991 US Open. Medvedev defeated three-time Grand Slam champion Stan Wawrinka 7-6 (8/6), 6-3, 3-6, 6-1 to reach his first major semi-final, shaking off a sore left quadriceps that made him contemplate quitting the match. Now he gets two days of rest. "That's huge advantage regarding what happened to my leg," Medvedev said. "It should be OK." Medvedev took a medical timeout, had the area taped and took a painkiller. "In the fourth set, I started feeling the painkiller and started moving better," he said. "For sure I hope to be ready for the semis." MEDVEDEV'S HOT SUMMER Medvedev has maintained momentum from a sizzling August in which he reached three ATP finals, winning a title at Cincinnati and finishing runner-up in Montreal and Washington. Medvedev, 23, is the youngest US Open semifinalist since Novak Djokovic in 2010 and Russia's first Slam semifinalist since Mikhail Youzhny at the 2010 US Open. Dimitrov and Medvedev have split two prior matches, Dimitrov winning at Queen's in 2017 and Medvedev avenging the loss a few weeks later in Washington. "He has been having a tremendous summer," Dimitrov said of Medvedev. "I know his game. I'm just going to try and recover and reassess the match first and prepare from then on for Daniil. He's a tough player. He's tricky." Wawrinka, foiled in a bid for his second US Open title in four seasons, said he did not think Medvedev would be holding the trophy on Sunday. "He can, but I don't think he will. I think it's going to be really difficult," Wawrinka said. "Because he looks to start to be tired, and he has to beat some more tougher player in the semi-final and then in the final." In Wednesday's quarter-finals, Spanish second seed Rafael Nadal, an 18-time Grand Slam champion, faces Argentine 20th seed Diego Schwartzman and French 13th seed Gael Monfils plays Italian 24th seed Matteo Berrettini.